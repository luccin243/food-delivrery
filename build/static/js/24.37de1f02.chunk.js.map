{"version":3,"sources":["components/users/Users.js"],"names":["Users","useState","users","setUsers","updateFirstName","updateLastName","updateRole","id","update","setUpdate","firstName","lastName","email","password","role","create","setCreate","loader","success","error","state","setState","init","a","getUsers","user","_id","token","data","isAuthenticated","useEffect","handelChangeCreate","props","event","target","value","onEdit","getUser","handelChangeUpdate","onSubmitCreate","preventDefault","createUser","message","onSubmitUpdate","updateUser","onCancel","onDisable","removeUser","parent","content","title","class","tabindex","aria-labelledby","type","data-dismiss","aria-label","onClick","aria-hidden","color","style","width","icon","action","placeholder","className","onChange","save","cancel","position","minHeight","map","_","i","onLoad"],"mappings":"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","file":"static/js/24.37de1f02.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport CardUsers from \"../../sections/CardUsers\";\r\nimport Footer from \"../footer/Footer\";\r\nimport Layout from \"../Layout\";\r\nimport Header from \"../navBar/Header\";\r\nimport ActionButton from \"../../sections/ActionButton\";\r\nimport Input from \"../../sections/Input\";\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\nimport {\r\n  createUser,\r\n  getUsers,\r\n  removeUser,\r\n  getUser,\r\n  updateUser,\r\n} from \"../../api/shop\";\r\nimport { isAuthenticated } from \"../../api/auth\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\n\r\nconst Users = () => {\r\n  const [users, setUsers] = useState(\"\");\r\n  const [update, setUpdate] = useState({\r\n    updateFirstName: \"\",\r\n    updateLastName: \"\",\r\n    updateRole: \"\",\r\n    id: \"\",\r\n  });\r\n\r\n  const [create, setCreate] = useState({\r\n    firstName: \"\",\r\n    lastName: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    role: \"\",\r\n  });\r\n\r\n  const [state, setState] = useState({\r\n    loader: false,\r\n    success: false,\r\n    error: \"\",\r\n  });\r\n\r\n  const init = async () => {\r\n    const data = await getUsers(user._id, token);\r\n    if (data.error) {\r\n      setState({ ...state, error: data.error });\r\n    }\r\n    setUsers(data);\r\n  };\r\n\r\n  const { loader, success, error } = state;\r\n  const { firstName, lastName, role, password, email } = create;\r\n  const { updateFirstName, updateLastName, updateRole, id } = update;\r\n  const { user, token } = isAuthenticated();\r\n\r\n  useEffect(() => {\r\n    init();\r\n  }, []);\r\n\r\n  const handelChangeCreate = (props) => (event) => {\r\n    setState({ error: false, success: false, loader: false });\r\n    setCreate({ ...create, [props]: event.target.value });\r\n  };\r\n\r\n  const onEdit = async (id) => {\r\n    const data = await getUser(id);\r\n    if (data.error)\r\n      return setState({ error: data.error, loader: false, success: false });\r\n    setUpdate({\r\n      updateFirstName: data.firstName,\r\n      updateLastName: data.lastName,\r\n      updateRole: data.role,\r\n      id: data._id,\r\n    });\r\n  };\r\n\r\n  const handelChangeUpdate = (props) => (event) => {\r\n    setState({ error: false, success: false, loader: false });\r\n    setUpdate({ ...update, [props]: event.target.value });\r\n  };\r\n\r\n  const onSubmitCreate = async (event) => {\r\n    event.preventDefault();\r\n    setState({ error: false, success: false, loader: true });\r\n    const data = await createUser(token, create);\r\n    if (data.error) return setState({ error: data.error, loader: false });\r\n    init();\r\n    setState({ error: false, success: data.message, loader: false });\r\n    setCreate({\r\n      firstName: \"\",\r\n      lastName: \"\",\r\n      role: \"\",\r\n      password: \"\",\r\n      email: \"\",\r\n    });\r\n  };\r\n\r\n  const onSubmitUpdate = (id) => async (event) => {\r\n    event.preventDefault();\r\n    setState({ error: false, success: false, loader: true });\r\n    const data = await updateUser(id, token, {\r\n      firstName: updateFirstName,\r\n      lastName: updateLastName,\r\n      role: updateRole,\r\n    });\r\n    if (data.error) {\r\n      return setState({ ...state, error: data.error, loader: false });\r\n    }\r\n    setState({ ...state, loader: false, success: data.message });\r\n    setUpdate({\r\n      ...update,\r\n      updateFirstName: data.firstName,\r\n      updateLastName: data.lastName,\r\n      updateRole: data.role,\r\n    });\r\n    init();\r\n  };\r\n\r\n  const onCancel = () => {\r\n    setCreate({\r\n      firstName: \"\",\r\n      lastName: \"\",\r\n      role: \"\",\r\n      password: \"\",\r\n      email: \"\",\r\n    });\r\n    setState({ error: false, success: false, loader: false });\r\n  };\r\n\r\n  const createModal = () => (\r\n    <div\r\n      class=\"modal fade myModal\"\r\n      tabindex=\"-1\"\r\n      role=\"dialog\"\r\n      aria-labelledby=\"myDefaultModalLabel\"\r\n    >\r\n      <div class=\"modal-dialog\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"close\"\r\n              data-dismiss=\"modal\"\r\n              aria-label=\"Close\"\r\n              onClick={onCancel}\r\n            >\r\n              <span aria-hidden=\"true\" class=\"fa fa-times\"></span>\r\n            </button>\r\n            <h5 class=\"modal-title\" id=\"myDefaultModalLabel\">\r\n              Nouvel utilisateur\r\n            </h5>\r\n          </div>\r\n          {loader && (\r\n            <LinearProgress color=\"secondary\" style={{ width: \"100%\" }} />\r\n          )}\r\n          <div class=\"modal-body\">\r\n            {(error || success) && (\r\n              <div\r\n                class={`alert bg-${\r\n                  error ? \"danger\" : \"success\"\r\n                } alert-dismissible fade show`}\r\n                role=\"alert\"\r\n              >\r\n                <strong>{error ? \"Erreur\" : \"Succès\"}!</strong>{\" \"}\r\n                {error ? error : success}\r\n              </div>\r\n            )}\r\n            <Input\r\n              icon=\"fa fa-user\"\r\n              action={handelChangeCreate(\"firstName\")}\r\n              value={firstName}\r\n              type=\"text\"\r\n              placeholder=\"Nom\"\r\n            />\r\n            <Input\r\n              icon=\"fa fa-user\"\r\n              action={handelChangeCreate(\"lastName\")}\r\n              value={lastName}\r\n              type=\"text\"\r\n              placeholder=\"Postnom\"\r\n            />\r\n            <Input\r\n              icon=\"fa fa-at\"\r\n              action={handelChangeCreate(\"email\")}\r\n              value={email}\r\n              type=\"text\"\r\n              placeholder=\"Email\"\r\n            />\r\n            <Input\r\n              icon=\"fa fa-unlock\"\r\n              action={handelChangeCreate(\"password\")}\r\n              value={password}\r\n              type=\"password\"\r\n              placeholder=\"Mot de passe\"\r\n            />\r\n            {user.role === 0 && (\r\n              <div className=\"form-group\">\r\n                <select\r\n                  onChange={handelChangeCreate(\"role\")}\r\n                  class=\"form-control\"\r\n                  value={role}\r\n                >\r\n                  <option value=\"\">Rôle</option>\r\n                  <option value={0}>Administrateur</option>\r\n                  <option value={1}>Distributeur</option>\r\n                  <option value={2}>Vendeur</option>\r\n                </select>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <ActionButton\r\n            save={onSubmitCreate}\r\n            loader={loader}\r\n            cancel={onCancel}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const updateModal = () => (\r\n    <div\r\n      class=\"modal fade myModalUpdate\"\r\n      tabindex=\"-1\"\r\n      role=\"dialog\"\r\n      aria-labelledby=\"myDefaultModalLabel\"\r\n    >\r\n      <div class=\"modal-dialog\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"close\"\r\n              data-dismiss=\"modal\"\r\n              aria-label=\"Close\"\r\n              onClick={onCancel}\r\n            >\r\n              <span aria-hidden=\"true\" class=\"fa fa-times\"></span>\r\n            </button>\r\n            <h5 class=\"modal-title\" id=\"myDefaultModalLabel\">\r\n              Modifier l'utilisateur\r\n            </h5>\r\n          </div>\r\n          {loader && (\r\n            <LinearProgress color=\"secondary\" style={{ width: \"100%\" }} />\r\n          )}\r\n          <div class=\"modal-body\">\r\n            {(error || success) && (\r\n              <div\r\n                class={`alert bg-${\r\n                  error ? \"danger\" : \"success\"\r\n                } alert-dismissible fade show`}\r\n                role=\"alert\"\r\n              >\r\n                <strong>{error ? \"Erreur\" : \"Succès\"}!</strong>{\" \"}\r\n                {error ? error : success}\r\n              </div>\r\n            )}\r\n            <Input\r\n              icon=\"fa fa-user\"\r\n              action={handelChangeUpdate(\"updateFirstName\")}\r\n              value={updateFirstName}\r\n              type=\"text\"\r\n              placeholder=\"Nom\"\r\n            />\r\n            <Input\r\n              icon=\"fa fa-user\"\r\n              action={handelChangeUpdate(\"updateLastName\")}\r\n              value={updateLastName}\r\n              type=\"text\"\r\n              placeholder=\"Postnom\"\r\n            />\r\n            {user._id !== id && (\r\n              <div className=\"form-group\">\r\n                <select\r\n                  onChange={handelChangeUpdate(\"updateRole\")}\r\n                  class=\"form-control\"\r\n                  value={updateRole}\r\n                >\r\n                  <option value=\"\">Rôle</option>\r\n                  <option value={0}>Administrateur</option>\r\n                  <option value={1}>Distributeur</option>\r\n                  <option value={2}>Vendeur</option>\r\n                </select>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <ActionButton\r\n            save={onSubmitUpdate(id)}\r\n            loader={loader}\r\n            cancel={onCancel}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const onDisable = async (id) => {\r\n    setState({ error: false, success: false, loader: true });\r\n    const data = await removeUser(id, token);\r\n    if (data.error) {\r\n      return setState({ error: data.error, success: false, loader: false });\r\n    }\r\n    init();\r\n    setState({ error: false, success: false, loader: false });\r\n  };\r\n\r\n  return (\r\n    <Layout>\r\n      <Header\r\n        parent=\"Accueil\"\r\n        content=\"Utilisateurs\"\r\n        title=\"Liste de utitlisateurs\"\r\n        create={true}\r\n      />\r\n      {createModal()}\r\n      {updateModal()}\r\n      <section className=\"main-content\">\r\n        <div className=\"row\" style={{ position: \"relative\", minHeight: 400}}>\r\n        {(!users || loader) && (\r\n            <div className=\"table-flex-center-user\">\r\n              <CircularProgress />\r\n            </div>\r\n          )}\r\n          {users &&\r\n            users.map((_, i) => {\r\n              if (_._id !== user._id) {\r\n                return (\r\n                  <CardUsers\r\n                    key={_._id}\r\n                    data={_}\r\n                    onLoad={loader}\r\n                    onEdit={() => onEdit(_._id)}\r\n                    onDisable={() => onDisable(_._id)}\r\n                  />\r\n                );\r\n              }\r\n            })}\r\n        </div>\r\n        <Footer />\r\n      </section>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Users;\r\n"],"sourceRoot":""}